# HistoryView - Модуль визуализации истории

![HistoryView Icon](static/HistoryView.png)

Система визуализации истории для просмотра истории свойств объектов с настраиваемыми графиками и виджетами.

## Описание

Модуль `HistoryView` предоставляет возможности визуализации истории для платформы osysHome. Он позволяет просматривать исторические данные свойств объектов, создавать пользовательские виджеты с графиками и анализировать тенденции во времени.

## Основные возможности

- ✅ **Просмотр истории**: Просмотр истории свойств объектов
- ✅ **Виджеты графиков**: Создание настраиваемых виджетов графиков
- ✅ **Типы графиков**: Линейный, столбчатый, сплайн, с заливкой, ступенчатый, круговой
- ✅ **Несколько свойств**: Отображение нескольких свойств в одном виджете
- ✅ **Временные периоды**: Настраиваемые временные периоды (часы)
- ✅ **Управление виджетами**: Создание, редактирование, удаление виджетов
- ✅ **Полноэкранные страницы виджетов**: Открытие виджетов на отдельных полноэкранных страницах
- ✅ **Поиск виджетов**: Поиск виджетов по названию и объектам.свойствам
- ✅ **Интеграция Highcharts**: Профессиональная библиотека графиков

## Панель администратора

Модуль предоставляет комплексный административный интерфейс:

### Главный вид
- **Список виджетов**: Просмотр всех созданных виджетов
- **Управление виджетами**: Создание, редактирование, удаление виджетов
- **Просмотр истории**: Просмотр истории свойств для конкретных объектов

### Конфигурация виджета
- **Имя виджета**: Отображаемое имя
- **Временной период**: Часы для отображения (0 для всех)
- **Свойства**: Выбор связанных свойств (Object.Property)
- **Тип серии**: Необязательное переопределение типа для свойства (иначе берется тип виджета)
- **Цвет серии**: Необязательное переопределение цвета (можно сбросить)
- **Тип графика**: Линейный, столбчатый, сплайн, с заливкой, ступенчатый, круговой
- **Опции графика**: Легенда, навигатор, селектор диапазона, контекстное меню

## Типы виджетов

### Линейный/Столбчатый/Сплайн/С заливкой/Ступенчатый график
- Визуализация временных рядов
- Поддержка нескольких свойств
- Интерактивное масштабирование и панорамирование
- Подсказки значений

### Круговая диаграмма
- Распределение значений
- Отображение агрегированных данных
- Отображение процентов

## Использование

### Создание виджета

1. Перейдите в модуль HistoryView
2. Нажмите "Create Widget"
3. Введите имя виджета
4. Установите временной период
5. Добавьте свойства (формат Object.Property)
6. (Опционально) Задайте тип и цвет для каждого свойства
7. Выберите тип графика (используется, если для свойства тип не задан)
8. Настройте опции графика
9. Сохраните виджет

### Просмотр истории

1. Перейдите в модуль HistoryView
2. Выберите объект из списка
3. Просмотрите историю свойств
4. Удалите записи истории при необходимости

### Просмотр графиков виджетов

1. Перейдите на `/page/HistoryView` для просмотра всех виджетов
2. Нажмите на карточку виджета, чтобы открыть его график в полноэкранном режиме
3. Используйте кнопку "Назад" для возврата к списку виджетов

### Поиск виджетов

Модуль поддерживает функциональность поиска:
- Поиск по названию виджета
- Поиск по объектам.свойствам (например, "Object.Property")
- Результаты поиска ведут напрямую на страницы виджетов

## Технические детали

- **Библиотека графиков**: Highcharts
- **Формат данных**: Пары временная метка-значение
- **Формат свойства**: Object.Property
- **Обработка времени**: Преобразование UTC в локальное время
- **Хранилище виджетов**: Конфигурация хранится в конфигурации модуля

## Версия

Текущая версия: **1.2**

## Категория

System

## Действия

Модуль предоставляет следующие действия:
- `widget` - Рендеринг виджетов истории для панели управления
- `page` - Рендеринг полноэкранных страниц виджетов (список или график отдельного виджета)
- `search` - Поиск виджетов по названию и объектам.свойствам

## Требования

- Flask
- SQLAlchemy
- Highcharts (JavaScript библиотека)
- Основная система osysHome

## Автор

Команда osysHome

## Лицензия

См. лицензию основного проекта osysHome

